<!-- HTML header for doxygen 1.10.0-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.10.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>VirtualC64: Headless App</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-sidebar-only.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-sidebar-only-darkmode-toggle.css" rel="stylesheet" type="text/css"/>
<link href="custom.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="doxygen-awesome-darkmode-toggle.js"></script>
        <script type="text/javascript">
            DoxygenAwesomeDarkModeToggle.init()
        </script>
</head>
<body>
  <!-- https://tholman.com/github-corners/ -->
<a href="https://github.com/dirkwhoffmann/virtualc64" class="github-corner" title="View source on GitHub" target="_blank" rel="noopener noreferrer">
    <svg viewBox="0 0 250 250" width="40" height="40" style="position: absolute; top: 0; border: 0; right: 0; z-index: 99;" aria-hidden="true">
    <path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a><style>.github-corner:hover .octo-arm{animation:octocat-wave 560ms ease-in-out}@keyframes octocat-wave{0%,100%{transform:rotate(0)}20%,60%{transform:rotate(-25deg)}40%,80%{transform:rotate(10deg)}}@media (max-width:500px){.github-corner:hover .octo-arm{animation:none}.github-corner .octo-arm{animation:octocat-wave 560ms ease-in-out}}</style>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="icon.png"/></td>
  <td id="projectalign">
   <div id="projectname">VirtualC64<span id="projectnumber">&#160;v5.0 beta</span>
   </div>
   <div id="projectbrief">Commodore 64 Emulator</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.10.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('md_pages_2headless.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">Headless App</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="autotoc_md2"></a> The purpose of the headless app is to perform a few simple smoke tests at the end of an automated build chain. It creates an emulator instance and utilizes the scripting interface to execute various RetroShell commands. The application is a good starting point to learn how to incorporate the emulator core into your project. It demonstrates how to launch the emulator, send commands to the command queue, and process messages within a registered message receiver.</p>
<div class="fragment"><div class="line"><span class="comment">// -----------------------------------------------------------------------------</span></div>
<div class="line"><span class="comment">// This file is part of VirtualC64</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// Copyright (C) Dirk W. Hoffmann. www.dirkwhoffmann.de</span></div>
<div class="line"><span class="comment">// This FILE is dual-licensed. You are free to choose between:</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">//     - The GNU General Public License v3 (or any later version)</span></div>
<div class="line"><span class="comment">//     - The Mozilla Public License v2</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// SPDX-License-Identifier: GPL-3.0-or-later OR MPL-2.0</span></div>
<div class="line"><span class="comment">// -----------------------------------------------------------------------------</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &quot;config.h&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;Headless.h&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;IOUtils.h&quot;</span></div>
<div class="line"><span class="preprocessor">#include &lt;chrono&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;filesystem&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;iostream&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#ifndef _WIN32</span></div>
<div class="line"><span class="preprocessor">#include &lt;getopt.h&gt;</span></div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> main(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> *argv[])</div>
<div class="line">{</div>
<div class="line">    <span class="keywordflow">try</span> {</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">return</span> vc64::Headless().main(argc, argv);</div>
<div class="line"> </div>
<div class="line">    } <span class="keywordflow">catch</span> (vc64::SyntaxError &amp;e) {</div>
<div class="line"> </div>
<div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;Usage: VirtualC64Core [-svm] | { [-vm] &lt;script&gt; } &quot;</span> &lt;&lt; std::endl;</div>
<div class="line">        std::cout &lt;&lt; std::endl;</div>
<div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;       -s or --selftest  Checks the integrity of the build&quot;</span> &lt;&lt; std::endl;</div>
<div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;       -v or --verbose   Print executed script lines&quot;</span> &lt;&lt; std::endl;</div>
<div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;       -m or --messages  Observe the message queue&quot;</span> &lt;&lt; std::endl;</div>
<div class="line">        std::cout &lt;&lt; std::endl;</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (<span class="keyword">auto</span> what = <span class="keywordtype">string</span>(e.what()); !what.empty()) {</div>
<div class="line">            std::cout &lt;&lt; what &lt;&lt; std::endl;</div>
<div class="line">        }</div>
<div class="line">        </div>
<div class="line">        <span class="keywordflow">return</span> 1;</div>
<div class="line"> </div>
<div class="line">    } <span class="keywordflow">catch</span> (<a class="code hl_struct" href="structvc64_1_1_error.html">vc64::Error</a> &amp;e) {</div>
<div class="line"> </div>
<div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;VC64Error: &quot;</span> &lt;&lt; std::endl;</div>
<div class="line">        std::cout &lt;&lt; e.<a class="code hl_function" href="structvc64_1_1_error.html#a14f6939a7c1cf873da6fbfee09f1e311">what</a>() &lt;&lt; std::endl;</div>
<div class="line">        <span class="keywordflow">return</span> 1;</div>
<div class="line">        </div>
<div class="line">    } <span class="keywordflow">catch</span> (std::exception &amp;e) {</div>
<div class="line"> </div>
<div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;Error: &quot;</span> &lt;&lt; std::endl;</div>
<div class="line">        std::cout &lt;&lt; e.what() &lt;&lt; std::endl;</div>
<div class="line">        <span class="keywordflow">return</span> 1;</div>
<div class="line">    </div>
<div class="line">    } <span class="keywordflow">catch</span> (...) {</div>
<div class="line">    </div>
<div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;Error&quot;</span> &lt;&lt; std::endl;</div>
<div class="line">    }</div>
<div class="line">    </div>
<div class="line">    <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">namespace </span><a class="code hl_namespace" href="namespacevc64.html">vc64</a> {</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span></div>
<div class="line">Headless::main(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> *argv[])</div>
<div class="line">{</div>
<div class="line">    std::cout &lt;&lt; <span class="stringliteral">&quot;VirtualC64 Headless v&quot;</span> &lt;&lt; c64.<a class="code hl_function" href="classvc64_1_1_virtual_c64.html#a587353dbe676464e3926bbf8cf4d62e0">version</a>();</div>
<div class="line">    std::cout &lt;&lt; <span class="stringliteral">&quot; - (C)opyright Dirk W. Hoffmann&quot;</span> &lt;&lt; std::endl &lt;&lt; std::endl;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Parse all command line arguments</span></div>
<div class="line">    parseArguments(argc, argv);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Redirect shell output to the console in verbose mode</span></div>
<div class="line">    <span class="keywordflow">if</span> (keys.find(<span class="stringliteral">&quot;verbose&quot;</span>) != keys.end()) c64.retroShell.<a class="code hl_function" href="structvc64_1_1_retro_shell_a_p_i.html#a7369f301fe922693d0d52347a576b4d5">setStream</a>(std::cout);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Read the input script</span></div>
<div class="line">    <span class="keyword">auto</span> script = MediaFile::make(keys[<span class="stringliteral">&quot;arg1&quot;</span>], FILETYPE_SCRIPT);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Launch the emulator thread</span></div>
<div class="line">    c64.<a class="code hl_function" href="classvc64_1_1_virtual_c64.html#a46e7edc38b721c75ddda3430754264dc">launch</a>(<span class="keyword">this</span>, vc64::process);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Execute the script</span></div>
<div class="line">    c64.retroShell.<a class="code hl_function" href="structvc64_1_1_retro_shell_a_p_i.html#adae752381f75b1979d627f4ff161f934">execScript</a>(*script);</div>
<div class="line">    barrier.lock();</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> returnCode;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#ifdef _WIN32</span></div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span></div>
<div class="line">Headless::parseArguments(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> *argv[])</div>
<div class="line">{</div>
<div class="line">    keys[<span class="stringliteral">&quot;selftest&quot;</span>] = <span class="stringliteral">&quot;1&quot;</span>;</div>
<div class="line">    keys[<span class="stringliteral">&quot;verbose&quot;</span>] = <span class="stringliteral">&quot;1&quot;</span>;</div>
<div class="line">    keys[<span class="stringliteral">&quot;arg1&quot;</span>] = selfTestScript();</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#else</span></div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span></div>
<div class="line">Headless::parseArguments(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> *argv[])</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">static</span> <span class="keyword">struct </span>option long_options[] = {</div>
<div class="line">        </div>
<div class="line">        { <span class="stringliteral">&quot;selftest&quot;</span>,   no_argument,    NULL,   <span class="charliteral">&#39;s&#39;</span> },</div>
<div class="line">        { <span class="stringliteral">&quot;verbose&quot;</span>,    no_argument,    NULL,   <span class="charliteral">&#39;v&#39;</span> },</div>
<div class="line">        { <span class="stringliteral">&quot;messages&quot;</span>,   no_argument,    NULL,   <span class="charliteral">&#39;m&#39;</span> },</div>
<div class="line">        { NULL,         0,              NULL,    0  }</div>
<div class="line">    };</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Don&#39;t print the default error messages</span></div>
<div class="line">    opterr = 0;</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Remember the execution path</span></div>
<div class="line">    keys[<span class="stringliteral">&quot;exec&quot;</span>] = fs::absolute(argv[0]);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Parse all options</span></div>
<div class="line">    <span class="keywordflow">while</span> (1) {</div>
<div class="line">        </div>
<div class="line">        <span class="keywordtype">int</span> arg = getopt_long(argc, argv, <span class="stringliteral">&quot;:svm&quot;</span>, long_options, NULL);</div>
<div class="line">        <span class="keywordflow">if</span> (arg == -1) <span class="keywordflow">break</span>;</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">switch</span> (arg) {</div>
<div class="line">                </div>
<div class="line">            <span class="keywordflow">case</span> <span class="charliteral">&#39;s&#39;</span>:</div>
<div class="line">                keys[<span class="stringliteral">&quot;selftest&quot;</span>] = <span class="stringliteral">&quot;1&quot;</span>;</div>
<div class="line">                <span class="keywordflow">break</span>;</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">case</span> <span class="charliteral">&#39;v&#39;</span>:</div>
<div class="line">                keys[<span class="stringliteral">&quot;verbose&quot;</span>] = <span class="stringliteral">&quot;1&quot;</span>;</div>
<div class="line">                <span class="keywordflow">break</span>;</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">case</span> <span class="charliteral">&#39;m&#39;</span>:</div>
<div class="line">                keys[<span class="stringliteral">&quot;messages&quot;</span>] = <span class="stringliteral">&quot;1&quot;</span>;</div>
<div class="line">                <span class="keywordflow">break</span>;</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">case</span> <span class="charliteral">&#39;:&#39;</span>:</div>
<div class="line">                <span class="keywordflow">throw</span> SyntaxError(<span class="stringliteral">&quot;Missing argument for option &#39;&quot;</span> +</div>
<div class="line">                                  <span class="keywordtype">string</span>(argv[optind - 1]) + <span class="stringliteral">&quot;&#39;&quot;</span>);</div>
<div class="line">                </div>
<div class="line">            <span class="keywordflow">default</span>:</div>
<div class="line">                <span class="keywordflow">throw</span> SyntaxError(<span class="stringliteral">&quot;Invalid option &#39;&quot;</span> +</div>
<div class="line">                                  <span class="keywordtype">string</span>(argv[optind - 1]) + <span class="stringliteral">&quot;&#39;&quot;</span>);</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Parse all remaining arguments</span></div>
<div class="line">    <span class="keyword">auto</span> nr = 1;</div>
<div class="line">    <span class="keywordflow">while</span> (optind &lt; argc) {</div>
<div class="line">        keys[<span class="stringliteral">&quot;arg&quot;</span> + std::to_string(nr++)] = fs::absolute(fs::path(argv[optind++])).string();</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Check for syntax errors</span></div>
<div class="line">    checkArguments();</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Create the selftest script if needed</span></div>
<div class="line">    <span class="keywordflow">if</span> (keys.find(<span class="stringliteral">&quot;selftest&quot;</span>) != keys.end()) keys[<span class="stringliteral">&quot;arg1&quot;</span>] = selfTestScript();</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span></div>
<div class="line">Headless::checkArguments()</div>
<div class="line">{</div>
<div class="line">    <span class="keywordflow">if</span> (keys.find(<span class="stringliteral">&quot;selftest&quot;</span>) != keys.end()) {</div>
<div class="line"> </div>
<div class="line">        <span class="comment">// No input file must be given</span></div>
<div class="line">        <span class="keywordflow">if</span> (keys.find(<span class="stringliteral">&quot;arg1&quot;</span>) != keys.end()) {</div>
<div class="line">            <span class="keywordflow">throw</span> SyntaxError(<span class="stringliteral">&quot;No script file must be given in selftest mode&quot;</span>);</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">    } <span class="keywordflow">else</span> {</div>
<div class="line"> </div>
<div class="line">        <span class="comment">// The user needs to specify a single input file</span></div>
<div class="line">        <span class="keywordflow">if</span> (keys.find(<span class="stringliteral">&quot;arg1&quot;</span>) == keys.end()) {</div>
<div class="line">            <span class="keywordflow">throw</span> SyntaxError(<span class="stringliteral">&quot;No script file is given&quot;</span>);</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">if</span> (keys.find(<span class="stringliteral">&quot;arg2&quot;</span>) != keys.end()) {</div>
<div class="line">            <span class="keywordflow">throw</span> SyntaxError(<span class="stringliteral">&quot;More than one script file is given&quot;</span>);</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="comment">// The input file must exist</span></div>
<div class="line">        <span class="keywordflow">if</span> (!util::fileExists(keys[<span class="stringliteral">&quot;arg1&quot;</span>])) {</div>
<div class="line">            <span class="keywordflow">throw</span> SyntaxError(<span class="stringliteral">&quot;File &quot;</span> + keys[<span class="stringliteral">&quot;arg1&quot;</span>] + <span class="stringliteral">&quot; does not exist&quot;</span>);</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">string</span></div>
<div class="line">Headless::selfTestScript()</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">auto</span> path = std::filesystem::temp_directory_path() / <span class="stringliteral">&quot;selftest.ini&quot;</span>;</div>
<div class="line">    <span class="keyword">auto</span> file = std::ofstream(path);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (isize i = 0; i &lt; isizeof(testScript) / isizeof(<span class="keyword">const</span> <span class="keywordtype">char</span> *); i++) {</div>
<div class="line">        file &lt;&lt; testScript[i] &lt;&lt; std::endl;</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">return</span> path.string();</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span></div>
<div class="line">process(<span class="keyword">const</span> <span class="keywordtype">void</span> *listener, Message msg)</div>
<div class="line">{</div>
<div class="line">    ((Headless *)listener)-&gt;process(msg);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span></div>
<div class="line">Headless::process(Message msg)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">static</span> <span class="keywordtype">bool</span> messages = keys.find(<span class="stringliteral">&quot;messages&quot;</span>) != keys.end();</div>
<div class="line">    </div>
<div class="line">    <span class="keywordflow">if</span> (messages) {</div>
<div class="line">        </div>
<div class="line">        std::cout &lt;&lt; MsgTypeEnum::key(msg.type);</div>
<div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;(&quot;</span> &lt;&lt; msg.value &lt;&lt; <span class="stringliteral">&quot;)&quot;</span>;</div>
<div class="line">        std::cout &lt;&lt; std::endl;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">switch</span> (msg.type) {</div>
<div class="line">            </div>
<div class="line">        <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="namespacevc64.html#acbbd5f70828660265bd996e23b58ce0baa4d10009296b03ca20e5e0782de8bcbd">MSG_SCRIPT_DONE</a>:</div>
<div class="line"> </div>
<div class="line">            returnCode = 0;</div>
<div class="line">            barrier.unlock();</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="namespacevc64.html#acbbd5f70828660265bd996e23b58ce0bacfb923a604b38a3581f9df2e17f31a86">MSG_SCRIPT_ABORT</a>:</div>
<div class="line">        <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="namespacevc64.html#acbbd5f70828660265bd996e23b58ce0bab5a09c07a9ce6862250f18e81ed80d3f">MSG_ABORT</a>:</div>
<div class="line"> </div>
<div class="line">            returnCode = 1;</div>
<div class="line">            barrier.unlock();</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">            </div>
<div class="line">        <span class="keywordflow">default</span>:</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line">}</div>
<div class="ttc" id="aclassvc64_1_1_virtual_c64_html_a46e7edc38b721c75ddda3430754264dc"><div class="ttname"><a href="classvc64_1_1_virtual_c64.html#a46e7edc38b721c75ddda3430754264dc">vc64::VirtualC64::launch</a></div><div class="ttdeci">void launch(const void *listener, Callback *func)</div><div class="ttdoc">Launches the emulator thread.</div><div class="ttdef"><b>Definition</b> VirtualC64.cpp:298</div></div>
<div class="ttc" id="aclassvc64_1_1_virtual_c64_html_a587353dbe676464e3926bbf8cf4d62e0"><div class="ttname"><a href="classvc64_1_1_virtual_c64.html#a587353dbe676464e3926bbf8cf4d62e0">vc64::VirtualC64::version</a></div><div class="ttdeci">static string version()</div><div class="ttdoc">Returns a version string for this release.</div><div class="ttdef"><b>Definition</b> VirtualC64.cpp:40</div></div>
<div class="ttc" id="anamespacevc64_html"><div class="ttname"><a href="namespacevc64.html">vc64</a></div><div class="ttdoc">VirtualC64 project namespace.</div><div class="ttdef"><b>Definition</b> CmdQueue.cpp:16</div></div>
<div class="ttc" id="anamespacevc64_html_acbbd5f70828660265bd996e23b58ce0baa4d10009296b03ca20e5e0782de8bcbd"><div class="ttname"><a href="namespacevc64.html#acbbd5f70828660265bd996e23b58ce0baa4d10009296b03ca20e5e0782de8bcbd">vc64::MSG_SCRIPT_DONE</a></div><div class="ttdeci">@ MSG_SCRIPT_DONE</div><div class="ttdoc">A RetroShell script has been successfully executed.</div><div class="ttdef"><b>Definition</b> MsgQueueTypes.h:46</div></div>
<div class="ttc" id="anamespacevc64_html_acbbd5f70828660265bd996e23b58ce0bab5a09c07a9ce6862250f18e81ed80d3f"><div class="ttname"><a href="namespacevc64.html#acbbd5f70828660265bd996e23b58ce0bab5a09c07a9ce6862250f18e81ed80d3f">vc64::MSG_ABORT</a></div><div class="ttdeci">@ MSG_ABORT</div><div class="ttdoc">The emulator requests the GUI to quit the app.</div><div class="ttdef"><b>Definition</b> MsgQueueTypes.h:37</div></div>
<div class="ttc" id="anamespacevc64_html_acbbd5f70828660265bd996e23b58ce0bacfb923a604b38a3581f9df2e17f31a86"><div class="ttname"><a href="namespacevc64.html#acbbd5f70828660265bd996e23b58ce0bacfb923a604b38a3581f9df2e17f31a86">vc64::MSG_SCRIPT_ABORT</a></div><div class="ttdeci">@ MSG_SCRIPT_ABORT</div><div class="ttdoc">The execution of a RetroShell ccript has been aborted.</div><div class="ttdef"><b>Definition</b> MsgQueueTypes.h:47</div></div>
<div class="ttc" id="astructvc64_1_1_error_html"><div class="ttname"><a href="structvc64_1_1_error.html">vc64::Error</a></div><div class="ttdoc">Emulator exception.</div><div class="ttdef"><b>Definition</b> Error.h:24</div></div>
<div class="ttc" id="astructvc64_1_1_error_html_a14f6939a7c1cf873da6fbfee09f1e311"><div class="ttname"><a href="structvc64_1_1_error.html#a14f6939a7c1cf873da6fbfee09f1e311">vc64::Error::what</a></div><div class="ttdeci">const char * what() const override</div><div class="ttdoc">Returns a textual description of this error.</div><div class="ttdef"><b>Definition</b> Error.cpp:259</div></div>
<div class="ttc" id="astructvc64_1_1_retro_shell_a_p_i_html_a7369f301fe922693d0d52347a576b4d5"><div class="ttname"><a href="structvc64_1_1_retro_shell_a_p_i.html#a7369f301fe922693d0d52347a576b4d5">vc64::RetroShellAPI::setStream</a></div><div class="ttdeci">void setStream(std::ostream &amp;os)</div><div class="ttdoc">Assign an additional output stream.</div><div class="ttdef"><b>Definition</b> VirtualC64.cpp:1018</div></div>
<div class="ttc" id="astructvc64_1_1_retro_shell_a_p_i_html_adae752381f75b1979d627f4ff161f934"><div class="ttname"><a href="structvc64_1_1_retro_shell_a_p_i.html#adae752381f75b1979d627f4ff161f934">vc64::RetroShellAPI::execScript</a></div><div class="ttdeci">void execScript(std::stringstream &amp;ss)</div><div class="ttdoc">Executes a script.</div><div class="ttdef"><b>Definition</b> VirtualC64.cpp:994</div></div>
</div><!-- fragment --><div class="section_buttons"></div><div class="section_buttons"><table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadLeft">Previous   </th><th class="markdownTableHeadRight">Next    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><a class="el" href="index.html#md_pages_2home">Home</a>   </td><td class="markdownTableBodyRight"><a class="el" href="md_pages_2state.html">State Model</a>   </td></tr>
</table>
</div><div class="section_buttons"></div> </div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.10.0 </li>
  </ul>
</div>
</body>
</html>
